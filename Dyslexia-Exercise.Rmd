---
title: "Dyslexia-Exercise"
author: "Dana Evelyn Jensen"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r pressure, echo=FALSE}
#Set Working Directory
setwd("C:\\Users\\danaj\\Documents\\GitHub\\Statistical_Methods_2")
library(pacman)
p_load(caret, e1071)

#load data
dyslexia <- read.table("dyslexia.txt", header=TRUE)

#split text based on "task"
d_text = dyslexia[dyslexia$Task == "Text",]
d_words = dyslexia[dyslexia$Task == "Words",]
d_nonwords = dyslexia[dyslexia$Task == "Non-Words",]

#change diagnosis to binary
dyslexia$Diagnosis[dyslexia$Diagnosis == 'noDyslexia'] <- '0'
dyslexia$Diagnosis[dyslexia$Diagnosis == 'Dyslexia'] <- '1'
dyslexia$Diagnosis <- as.numeric(dyslexia$Diagnosis)

#make a logistic regression with one predictor(baseline)
m1 = glm(Diagnosis ~ Mistakes, data = dyslexia, family = "binomial")
m1_sum = summary(m1)

#make a vector which predicts "response"
predictions = predict(d_nonwords, type = "response")

#if 'response' is <.5, label as 'noDyslexia', vice versa
predictions
predicted_diagnosis = ifelse(predictions<.5,"0","1")
predicted_diagnosis

#make a matrix to see how accurate predictions of diagnosis are
d.Matrix = caret::confusionMatrix(predicted_diagnosis, d$Diagnosis, positive = "Dyslexia")
d.Matrix

#multiple regression to test different hypothesis of predictors
m.Words = glm(Diagnosis ~ SyllableN, data = d.Words,family = "binomial")

#View coefficients, chisq, p-values, fischer values
summary(m.Words)
anova(m.Words,test = "Chisq")

m.Text = glm(Diagnosis ~ SyllableN + Duration, data = d.Text,family = "binomial")
summary(m.Text)
anova(m.Text, test = "Chisq")

m.non.Words = glm(Diagnosis ~ SyllableN + SyllablePerVoicedSecond, data = d.non.Words, family = "binomial")
summary(m.non.Words)
anova(m.non.Words, test = "Chisq")

caret::confusionMatrix(predicted_diagnosis,d.non.Words$Diagnosis,positive="Dyslexia")

```


